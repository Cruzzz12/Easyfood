{% extends 'recipes/base.html' %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="mb-0">Mis recetas</h1>
    <a href="/recipe/add/" class="btn btn-primary">Añadir receta</a>
  </div>

  <div class="row gy-3">
    {% for r in recipes %}
      <div class="col-12">
        <div class="card list-card card-recipe">
          <div class="row g-0">
            {% if r.image %}
            <div class="col-md-3 img-col">
              <img src="{{ r.image.url }}" alt="{{ r.title }}">
            </div>
            <div class="col-md-9 content-col">
            {% else %}
            <div class="col-12 content-col">
            {% endif %}
              <div class="card-body">
                <div>
                  <h5 class="card-title"><a class="stretched-link text-decoration-none" href="{% url 'recipes:detail' r.pk %}">{{ r.title }}</a></h5>
                  <p class="card-text text-muted small mb-2"><i class="bi bi-clock me-1"></i> {{ r.estimated_time|default:'-' }} min &nbsp; <i class="bi bi-star-fill text-warning ms-2 me-1"></i> {% if r.avg_rating %}{{ r.avg_rating|floatformat:1 }}{% else %}Sin valor{% endif %}</p>
                  <p class="card-text text-muted mb-2">{% for i in r.ingredients.all|slice:":6" %}<span class="ingredient-badge">{{ i.name }}</span>{% endfor %}{% if r.ingredients.count > 6 %} <span class="text-muted">... y más</span>{% endif %}</p>
                </div>
                <div>
                  <p class="card-text">{{ r.description|striptags|truncatewords:28|linebreaksbr }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-12">
        <div class="alert alert-info">No has creado recetas todavía. Crea tu primera receta!</div>
      </div>
    {% endfor %}
  </div>
{% endblock %}
